# ChangeLog

0.7.0
    * Work around a bug: pinter in serial print mode while wizard is shown
    * Flag checked replaced by prepared
    * New status display
      - notifies about setup wizard,
      - shows upload progress
      - shows the name of a file being printed
      - notifies about errors
      - shows an idle screen with the IP address after 30min
    * Name and location of printer in ini file is wrapped by quotes, "#" sign encoded in URL
    * Fix negative timeout being possible in serial read
    * Change of name / location of printer in PrusaLink fixed (added quotes, removed from endpoint json)
    * Added option for skip Connect registration in wizard
    * Added registration status and code values to api/connection GET endpoint
    * Added connect section to api/connection POST
    * Fixed additional registration process
    * File name forbidden characters check moved to SDK, added functions for check it and check file name length
    * Fixed transfer and print in ATTENTION error
    * Added function for check foldername length (from SDK)
    * Attribute file_path in job info changed to path
    * Fix PrusaLink IP not getting reset from printer on shutdown
    * Fix the serial_number step in wizard
    * Modified endpoint api/files to optionally get specific directory instead of whole tree
    * Added '/api/files/<target>/<path:re:.+>/raw' endpoint
    * Fix unicode characters in file names breaking lcd printer
    * Make RESET_PRINTER clear the command queue and have priority that way
    * Made the app stop itself faster
    * Use M400 instead of G4 for printer queue syncing
    * Added printer name and location validation to wizard
    * Reworked errors in validation of printer name and location in Link settings
    * Reworked validation of correct S/N write
    * Modified username length and password length and format validation
    * Use "Sync|->:" and "Sync->|:" to signify which way is the current transfer going
    * Add DNS service discovery compatible with prusa-slicer
    * Support file upload cancels from prusa-slicer (once PoorWSGI updates)
    * Added endpoints for create and delete of folder and relocating the file
    * Static web update:
      - Fix big log files displaying
      - Decrease display log file size limit to 1M
      - Change temperature controls widget number format to display integers
      - Add stop/resume print button
      - Add protection from steppers disabling when printing
      - Fix upload widget toggles on interaction with projects list
      - Fix sidebar width
      - Replace PNG icons with SVG
      - Fix router, telemetry graph dinmensions and page layout
      - Update error handling to avoid duplicates of popups
      - Add FE version output to console log
      - Add support for file extensions provided by printer profiles from API
      - Fix display names of origins
      - New application design
      - New field to rename project file uploaded by URL
      - New widget displaying used/free size (not-connected to printer yet)
      - New Rename and Copy actions (hidden)
      - New tool to unify icons colors
      - Fixed icons colors
      - Updated free space logic
      - Fixed storage tabs behavior
      - Avoid unnecessary requests to BE for file metadata
      - Hardcode storages list to printers
      - Removed page `Temperatures`
      - Fix formatting of percentages
      - Reworked text styles
      - Changed white color to light gray
      - Project preview is now not dependent on `/api/job` endpoint
     * Differentiate between FW and ID errors in the wizard, update texts
     * Fix ID error being swapped with the FW error
     * Fixed download ref, added total storage space info
     * Added storage space info to api/printer
     * Added function for save file with custom name
     * Fix files not reloading when already selected for printing, but overwritten
     * Add dynamic download throttling when printing
     * Exclude diacritic from username
     * time_estimated changed to time_remaining (time_remaining kept for compatibility)
     * Added check for spaces on the beginning and the end of the username
     * Added check for new S/N format and info to contact the customer support
     * Added caching for thumbnail images
     * Send printer info on printer reset / info invalidation event
     * Fixed error handling for PrusaLink Web
     * Add idle screen and show transfers during print pauses
     * Added endpoint for unregistering the printer
     * Reset print stats after a print ends
     * Fix print fail from a unchecked print buffer underflow
     * Report mesh bed leveling data
     * Use the print mode to report the right print stats row to connect
     * Make sure fan errors send reason, improve their behavior a little
     * READY state changed to IDLE, PREPARED state changed to READY
     * Added endpoint for set/cancel printer READY state
     * Re-registration can be done only with deleted token
     * Fix SD Card module race conditions
     * Make it possible to hide certain loggers from interesting log
     * Filter telemetry, send only what's "significantly" changed
     * Fixed maximum temperature check for nozzle and heatbed
     * Api-Key is implicitly None, can be set in wizard or using endpoint
     * Start PrusaLink even without a connection to the printer
     * Start sending telemetry slowly after a period of inactivity
     * Files can be printed without selecting first, fixed job printTime info in api/job
     * Don't wait for a printer to boot when running through the EINSY pins
     * Added api/v1/info endpoint
     * Add printer statistics tracking
     * Add time to filament change tracking
     * Fix mbl data format
     * Add sheet settings tracking
     * Return a better reason when print of a non existant file is requested
     * Api-Key form is hidden in wizard by default -> None if not set
     * Fix the LCD printer going through errors in the wrong order
     * Make printer settings reflect the actual printer type
     * Fixed doubled gcode extensions when custom name is used

0.6.0 (2021-12-17)
    * Added endpoint for control of extruder
    * Added endpoint for heatbed temperature control
    * Static web update
      - Add debug outputs to investigate project picture collision
      - Removed unnecessary colon after hostname in Dashboard
      - Switched from data.link to data.printer for settings end point
      - Add advanced upload widget
      - Printer Control Page
      - Add target temperatures to the left sidebar
      - Add possibility to send control values by Enter key press
      - Add serial number setting
      - Prevent api polling when previous requests were not handled
      - Prevent error messages flood in case of a connection problem
      - Optimize application loop
      - Add serial, CONNECT and communication state to the left side bar
    * Added size and date attributes to api/logs GET endpoint
    * Removed m_time file attribute
    * Added restriction for forbidden characters in uploaded file name
    * Added download and basic upload info to link-info page
    * Added and implemented JSON file with HW limits
    * Added api/printer/printhead GET endpoint
    * Changed variable firmware_version to firmware
    * Added LOAD/UNLOAD filament commands
    * Added disable_steppers command to api/printer/printhead
    * Implementation of farm_mode into api/settings endpoints
    * New Upload errors
      - check Content-Length header
      - check if file is uploaded complete
      - check storage free space first
      - errors refactoring
      - simple html errors
    * Changed args to kwargs for high level commands
    * HTTP Request handling improvement
    * own Serial class implementation (speed improvement)
    * Changed args to kwargs for execute_gcode command
    * log thread stack on interesting events
    * move job_id into the EEPROM
    * make STOP_PRINT wait for any of the READY, STOPPED or FINISHED states
    * Implementation of new Transfer object from SDK
    * Make a centralised wizard activation condition
    * Download finished callback implementation
    * Fix SD initialising always as PRESENT even when ABSENT

0.5.1 (2021-07-16)
    * Implementation of print after upload endpoint
    * Minimal suported firmware is 3.10.0
    * Sort files directory first, newest first
    * Faster checking and processing when uploading gcode
    * Static web update
      - Upload gcode fixes
      - File browser is available when printer printes
      - Files are sort by printers API
      - Printed file widget rework
      - Fixed progress bar behaviour when printing is finished
      - Fixed error handling for periodic requests
      - Page heading is sticky now
      - Telemetry sidebar is sticky now
      - Added frontend version to the Settings page
      - Fixed 'undefined' error pop up heading in some cases
      - Log viewer
      - Login and password can be changed in settings
      - All not available project properties are hidden
      - Toaster messages are now sticky to window bottom
      - Fixed printing time estimations missmatching
      - Printer name and location can be changed in settings
      - Files with size above 100MB won't be loaded into textarea
    * React to thermal runaway by going into the error state
    * Use daemon type WSGI threads
    * Removed temporary gcode copy for printing
    * Support the new M20 attributes and their order
    * Fix progress equal to -1 not being supported
    * Fixed upload from local web
    * SEND_INFO hostname fixed
    * Fix SD Card file selection
    * Log HTTP requests and errors over Python Logger
    * Improve FW error message support
    * Work around print head returning to the print after Stop print
    * Added endpoint for download file from url
    * Password in plain text form is not stored in memory
    * Added endpoint for gettting info about the file currently being downloaded
    * Added endpoint for abort current download process
    * Require user attention after each print, even failed ones (if enabled)
    * Added checked and finished flags to api/printer
    * Added states structure to api/connection endpoint
    * Added Connect configuration info to api/connection endpoint
    * Added connection.py with api/connection GET, POST endpoints
    * Added api/settings GET endpoint
    * Added m_timestamp to SDCard files properties
    * Added api/settings POST endpoint, fix settings.py name
    * Fixed /api/printer flags
    * Implementation of gcode download endpoint
    * Added api/logs endpoint
    * Added api/logs/<log_file> endpoint
    * Added wizard/serial endpoints and page for setup S/N of the printer
    * Updated metadata for selected file
    * Require two "Not SD printing" to work around a SD printing bug
    * Added username and password change functionality to api/settings POST, fixed ChangeLog
    * Fixed SD Card metadata read
    * Go into the ERROR state when the printer stops responding for aprox. one minute
    * Added endpoint for regenerate api-key
    * Added api/settings/sn endpoint for setup S/N of the printer
    * Wizard is locked after successful configuration
    * Added endpoint for control of printhead movement
    * Added endpoint GET api/settings/sn

0.4.0 (2021-04-13)
    * getting IP refactoring
    * fix firmware version reading
    * working download gcode endpoint
    * command argument for profiling application
    * connection over VPN fix
    * Added additional network info

0.3.0 (2021-03-30)

    * Fixed broken command resends
    * Fixed state changed handler
    * Added new endpoint /api/connections with JSON response
    * Skipped pidfile when process is not alive
    * Added new endpoint /api/printer with JSON response
    * Fixed complaint in wizard about `api-key` when `username` was too short
    * Fix printer.sn being unset in the wizard by waiting for it
    * Fixed some telemetry being sent basically at random
    * Enabled the RESET_PRINTER command
    * Fixed printer resetting multiple times when it gets reset mid-print
    * Fixed accidentally hogging CPU when displaying LCD messages
    * Set log levels by module name in config or as command arguments
    * Report whether the current job is from the SD or not
    * Support long file names in the upcoming 3.10 release (file explorer only)
    * Added new endpoint /api/files with JSON response
    * Added new endpoint /api/job with JSON response
    * Added support for the new C parameter in M155
    * Modification of /api/connection, files, printer and job endpoints
    * All files in data_dir (user's home by default)
    * Parse print info from the file name (for SD files)
    * Introduce ErrorState(s) from SDK
    * Modify `LCDPrinter` to show IP and status based on SDK error states
    * Support the nem M27 P
    * Fix not being able to print from root of SD when in a folder in LCD menu
    * Send 0% when a new print start is observed
    * Fix no progress being sent when SD print has no stats in its gcode
    * Support fan errors. Send reason for ATTENTION state in state change data
    * Support showing the IP address in the support menu using "M552 P<IP>"
    * /link-info debug page
    * SN is obtained always through the FW and isn't stored in a file anymore
    * Ensure M20 won't be sent during print. Ever
    * Start faster when already printing from SD
    * Don't store password in plaintext but use digest
    * Stop Wizard on printer errors.
    * Support the new STOPPED state
    * Use X-Api-Key or HTTP Digest for /api endpoints
    * hostname in /api/version
    * Fix /api/endpoints
    * Fix /api/files and /api/job endpoints
    * Nicer messages for Wlan errors; LCDPrinter now accesses the model for IP
    * Statics generated from submodule
    * Support pausing, resuming and stopping of serial prints from the LCD
    * Implementation of metadata into /api/files endpoint
    * Process all commands in a single thread -> racing avoided
    * Uploading from local web
    * Prusa Link version in INFO event
    * G-code preview and download endpoints
    * Thread names via prctl - can be show in htop
    * Shutdown fix
    * Report build number alongside firmware version
    * Added api commands for pause, stop and resume print job
    * If-Modified-Since and If-None-Match headers support for /api/files
    * Additional version info
    * Files in hidden folder are ignored
    * Report file names of SD prints better
    * Added endpoint for start print
    * LCD message modification (GO: <IP>)
    * Fix connection errors causing the printer to report being in ERROR state
    * Add the possibility to log at debug level around interesting events
    * Distinguish wifi from lan
    * Implementation of select/print file functions from local web
    * File resource endpoint
    * working `start / stop / pause / resume` job
    * job info refactoring
    * endpoint for deleting file
    * fix job get / set

0.2.0 (2020-12-14)

    * JOB_INFO fix
    * Service must be start using daemon script prusa-link
    * Implicit config path is /etc/Prusa-Link/prusa-link.ini
    * Implicit settings path is {HOME}/prusa_printer_settings.ini
    * Wizard - part II
    * Api-Key in INFO event
    * Wizard redesign


0.1.3 (2020-12-01)

    * Report at least a file name for SD prints
    * Wizard - part I
    * Fix command handling and re-undo fw double-ok workarounds
      (FW commit gd167b3bd or newer is required)

0.1.2 (2020-11-23)

    * New FW (3.9.2.3566) required
    * local web service on http://IP-address:8080
    * file upload from Prusa Slicer (use `PrusaSlicer` Api-Key)
